<script src="http://maps.google.com/maps?file=api&amp;v=2.x&amp;key=ABQIAAAAzr2EBOXUKnm_jVnk0OJI7xSosDVG8KKPE1-m51RBrvYughuyMxQ-i1QfUnH94QxWIa6N4U6MouMmBA" type="text/javascript"></script>

<script language="javascript" type="text/javascript">
        $(document).ready(function () {
        $("#locate").click(function (e) {
                e.preventDefault(); /* prevents form from being submitted */
                var ikey = $('#location_location_name').val();
                
                var geoloc = locateGeo(ikey,$('#location_geo_lat'),$('#location_geo_long'));
            });
        });

    var map = null;
    var geocoder = null;
    var pts = new Array();

    function locateGeo(address, elem1,elem2) {
      geocoder = new GClientGeocoder();
      if (geocoder) {
        geocoder.getLatLng(
          address,
          function(point) {
            if (!point) {
              alert(address + " not found");
            } else {              
              var marker = new GMarker(point);
              elem1.val(point.y);
              elem2.val(point.x);
    
            }
          }
       );
    
       }}

</script>
<%= form_for(@location) do |f| %>
  <% if @location.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@location.errors.count, "error") %> prohibited this post from being saved:</h2>

      <ul>
      <% @location.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :location_name %><br />
    <%= f.text_field :location_name %><button name="locate" id="locate" >Locate</button>
  </div>
  <div class="field">
    <%= f.label :geo_lat %><br />
    <%= f.text_field :geo_lat %>
  </div>
  <div class="field">
    <%= f.label :geo_long %><br />
    <%= f.text_field :geo_long %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>
